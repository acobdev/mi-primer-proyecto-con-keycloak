{"version":3,"file":"ContentPages.js","names":["React","Route","Switch","NavItem","NavExpandable","Msg","PageNotFound","ForbiddenPage","isModulePageDef","item","modulePath","undefined","isExpansion","contentItem","content","groupId","group","itemId","isChildOf","parent","child","createNavItems","activePage","contentParam","groupNum","createElement","Fragment","links","map","navLinkId","id","key","title","localize","label","labelParams","isExpanded","page","to","path","isActive","type","makeNavItems","console","log","setIds","expansionGroupNum","i","length","initGroupAndItemIds","flattenContent","pageDefs","flat","push","makeRoutes","routes","node","module","componentName","exact","render","pageDef","component"],"sources":["../src/app/ContentPages.tsx"],"sourcesContent":["/*\n * Copyright 2019 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from 'react';\nimport {Route, Switch} from 'react-router-dom';\nimport {NavItem, NavExpandable} from '@patternfly/react-core';\nimport {Msg} from './widgets/Msg';\nimport {PageNotFound} from './content/page-not-found/PageNotFound';\nimport { ForbiddenPage } from './content/forbidden-page/ForbiddenPage';\n\nexport interface ContentItem {\n    id?: string;\n    label: string;\n    labelParams?: string[];\n    hidden?: string;\n    groupId: string; // computed value\n    itemId: string; // computed value\n};\n\nexport interface Expansion extends ContentItem {\n    content: ContentItem[];\n}\n\nexport interface PageDef extends ContentItem {\n    path: string;\n}\n\nexport interface ComponentPageDef extends PageDef {\n    component: React.ComponentType;\n}\n\nexport interface ModulePageDef extends PageDef {\n    modulePath: string;\n    componentName: string;\n    module: React.Component; // computed value\n}\n\nexport function isModulePageDef(item: ContentItem): item is ModulePageDef {\n    return (item as ModulePageDef).modulePath !== undefined;\n}\n\nexport function isExpansion(contentItem: ContentItem): contentItem is Expansion {\n    return (contentItem as Expansion).content !== undefined;\n}\n\ndeclare const content: ContentItem[];\n\nfunction groupId(group: number): string {\n    return 'grp-' + group;\n}\n\nfunction itemId(group: number, item: number): string {\n    return 'grp-' + group + '_itm-' + item;\n}\n\nfunction isChildOf(parent: Expansion, child: PageDef): boolean {\n    for (var item of parent.content) {\n        if (isExpansion(item) && isChildOf(item, child)) return true;\n        if (parent.groupId === child.groupId) return true;\n    }\n\n    return false;\n}\n\nfunction createNavItems(activePage: PageDef, contentParam: ContentItem[], groupNum: number): React.ReactNode {\n    if (typeof content === 'undefined') return (<React.Fragment/>);\n\n    const links: React.ReactElement[] = contentParam.map((item: ContentItem) => {\n        const navLinkId = `nav-link-${item.id}`;\n        if (isExpansion(item)) {\n            return <NavExpandable id={navLinkId}\n                                  groupId={item.groupId}\n                                  key={item.groupId}\n                                  title={Msg.localize(item.label, item.labelParams)}\n                                  isExpanded={isChildOf(item, activePage)}\n                                  >\n                        {createNavItems(activePage, item.content, groupNum + 1)}\n                    </NavExpandable>\n        } else {\n            const page: PageDef = item as PageDef;\n            return <NavItem id={navLinkId}\n                            groupId={item.groupId}\n                            itemId={item.itemId}\n                            key={item.itemId}\n                            to={'#/' + page.path}\n                            isActive={activePage.itemId === item.itemId}\n                            type=\"button\">\n                        {Msg.localize(page.label, page.labelParams)}\n                    </NavItem>\n        }\n    });\n\n    return (<React.Fragment>{links}</React.Fragment>);\n}\n\nexport function makeNavItems(activePage: PageDef): React.ReactNode {\n    console.log({activePage});\n    return createNavItems(activePage, content, 0);\n}\n\nfunction setIds(contentParam: ContentItem[], groupNum: number): number {\n    if (typeof contentParam === 'undefined') return groupNum;\n    let expansionGroupNum = groupNum;\n\n    for (let i = 0; i < contentParam.length; i++) {\n        const item: ContentItem = contentParam[i];\n        if (isExpansion(item)) {\n            item.itemId = itemId(groupNum, i);\n            expansionGroupNum = expansionGroupNum + 1;\n            item.groupId = groupId(expansionGroupNum);\n            expansionGroupNum = setIds(item.content, expansionGroupNum);\n            console.log('currentGroup=' + (expansionGroupNum));\n        } else {\n            item.groupId = groupId(groupNum);\n            item.itemId = itemId(groupNum, i);\n        }\n    };\n\n    return expansionGroupNum;\n}\n\nexport function initGroupAndItemIds(): void {\n    setIds(content, 0);\n    console.log({content});\n}\n\n// get rid of Expansions and put all PageDef items into a single array\nexport function flattenContent(pageDefs: ContentItem[]): PageDef[] {\n    const flat: PageDef[] = [];\n\n    for (let item of pageDefs) {\n        if (isExpansion(item)) {\n            flat.push(...flattenContent(item.content));\n        } else {\n            flat.push(item as PageDef);\n        }\n    }\n\n    return flat;\n}\n\nexport function makeRoutes(): React.ReactNode {\n    if (typeof content === 'undefined') return (<span/>);\n\n    const pageDefs: PageDef[] = flattenContent(content);\n\n    const routes: React.ReactElement<Route>[] = pageDefs.map((page: PageDef) => {\n        if (isModulePageDef(page)) {\n            const node: React.ReactNode = React.createElement(page.module[page.componentName], {'pageDef': page});\n            return <Route key={page.itemId} path={'/' + page.path} exact render={() => node} />;\n        } else {\n            const pageDef: ComponentPageDef = page as ComponentPageDef;\n            return <Route key={page.itemId} path={'/' + page.path} exact component={pageDef.component}/>;\n        }\n    });\n\n    return (<Switch>\n                {routes}\n                <Route path=\"/forbidden\" component={ForbiddenPage}/>\n                <Route component={PageNotFound}/>\n            </Switch>);\n}\n"],"mappings":"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"}